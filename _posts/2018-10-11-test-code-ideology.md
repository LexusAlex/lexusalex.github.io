--- 
layout: post 
title: Тестирование кода. Идеология
permalink: test-code-ideology
tags: testCode php
comments: true

--- 

Что же такое тестирование кода и зачем это нужно.

Допустим, начинаем проект "Калькулятор". 
Написали, выкатили в прод, пусть это будет большой калькулятор, состоящий из нескольких тысяч строк кода.

К нам начинают сыпаться баги, сразу же их фиксим и назад в прод, поправили, работает, снова правим и т.д.
Это сейчас, хорошо мы помним, что и где было исправлено, а через год, вы легко сможете воспроизвести баг? 
Cкорее всего нет.
Нужна некая сетка безопасности, страховка, что все работает. 
Такой сеткой являются Автоматические тесты или как их еще называют Юнит тесты.

Современные программы сожержат множество зависимостей и ошибок. 

К примеру ошибки типизации (`1 + []`), недопустимые операции, логические ошибки и другие.

Обнаружить такие ошибки можно руками (`var_dump(), echo, print_r()`) или используя автоматическое тестирование.

### Ручное тестирование

Проблемы при ручном тестировании:

1. Отсуствие повторяемости. 
   Одни и те же действия по выявлению ошибок нужно делать многократно, при этом нельзя точно сказать что было
   протестировано, а что нет
1. Ручные тесты "долгие" - это значит можно часами сидеть и не видеть ошибку
1. Невнимательность, человеческий фактор, не все было проверенно
1. Бесконечные правки
1. Изменения в коде стоят дорого
1. В одном месте поправил, сломалось в другом
1. **Руками все проверить просто невозможно**

### Автоматическое тестирование

Что же дают нам тесты, и как это облегчает жизнь:

1. Отладку кода можно сразу вести из тестов, без надобности писать редиректы, заглушки, `exit();`, `var_dump()`
1. По тесту можно сразу понять как работает метод, функция, без лишних конструкций. ("Живая документация")
1. Помогают не допускать регрессии готового кода, то есть "новый" код не сломает существующий
1. Приучают писать маленькие методы и чистые функции , а не пихать всю логику в один метод, который сложно тестировать
1. Помогают в ходе написания теста понять как писать менее связанный код
1. Автоматическая проверка избавляет разработчика от монотонной работы
1. Уверенность за свой код
1. Разработка без страха
1. Поддержка без боли для других


### Каким должен быть автоматический тест

1. Повторяемым
1. Простым для понимания
1. Его легко запустить
1. Быть быстым
1. Тест должен всегда для одних и тех же наборов данных возвращать один и тот же результат
1. Работать независимо от других тестов
1. При падении теста, понять каким должен быть результ и где произошла ошибка.
1. Не зависеть от внешного окружения
1. Проверять все возможные результаты исходя из параметров
1. Один тест - одна функция
1. Запускаться регулярно
1. Единый стиль написания теста, код должен быть простым для поддержки.

На написание тестов нужно тратить время, иногда значительное, так же необходимо поддерживать их в актуальном состоянии 


### Почему не пишут тесты
    
1. Нет времени на них, бизнес не будет ждать, пока ты будешь писать тесты
1. Нет денег на написание, дорого (это доп расходы, затраты)
1. Команда никогда не писала тестов
1. Нет смысла писать тесты, если никому это не нужно

И еще вам не нужно писать тесты если вы всегда пишете код без ошибок, 
обладаете идеальной памятью и даром предвидения. 
Ваш код настолько крут, что изменяет себя сам, вслед за требованиями клиента. 
Иногда сам код объясняет клиенту, что его требования - не нужно реализовывать.

