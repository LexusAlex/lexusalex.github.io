---
layout: post
title:  Боль разработчика.Ошибки и костыли
date:   2018-02-23
author: Алексей Шмелев
categories: development
comments: true
cover:  "/assets/pain/pain1.jpg"
---

Начинаю писать про то с какими проблемами сталкивается разработчик ПО.

### Не идеальный мир

Костыль(хак) - это ветвление, захаркоживание, быстрое решение.
Мы вынуждены поддерживать чужой код, исправлять ошибки предыдущих членов команды, править тонны легаси кода изменения которого обходятся дорого.

Начинаем делать проект по всем правилам хорошего кода с использованием гибких архитектур продумывание мелочей, проект готов. 
Спустя какое-то время начинаются проблемы, а именно 1. ошибка в стороннем api 2. начальник сказал "Нужно когда, на сайт заходит Вася Петров выводить сообщение: Поздравление с новым годом!, или, отправлять письмо что вы зашли на сайт" 3. коллега подключил свою библиотеку со своими заморочками и залил в систему контроля версий.
Конечно, объяснять в тысячный раз ты не будешь, а будешь городить городушки ifов под каждую ситуацию. С течением времени таких новых требований, багов и ifов все больше, полезного кода все меньше. 

При чем, если делать задачи четко по ТЗ, то довольно быстро получишь легаси, потому что продакт менеджеры меняются, выходят новые браузеры, короче, окружение становится другим. 
В таком случае нужно спроектировать систему так, чтобы при любых изменениях исходная структура сохранялась, но это по-моему тема отдельного разговора.
О какой красоте кода может идти речь, принцип "Главное чтобы работало" или "Работает не трогай", никто не отменял, заказчику твоя красота кода и гибкость архитектуры не нужна.

Код должен отражать реальный мир. 
В ТЗ было сказано что все кнопки на сайте должны быть зеленого цвета, мы так и делаем, тупо пишем метод, который выводит кнопку зеленым цветом. 
Все идет очень хорошо, но завтра заказчик просит нас на главной странице сделать кнопку красной (ясное дело ``if(page == index) {button == red}``), 
послезавтра на каждой четной странице сайта по рабочим дням для пользователей из США сделать кнопки серыми, а по выходным желтыми, но только на тех страницах, на которых были совершены покупки за последние 2 часа с учетом часового пояса пользователя. Так же предусмотреть смену цвета самим пользователем по алгоритму... Чувствуете? Голова кругом , я конечно усложняю, но суть понятна.
И так далее.

Вся ваша красота кода коту под хвост, как решаем, конечно усложнением, абстракциями.
Под каждый чих делаем новый метод с отличающимся набором входных параметров, один метод для рисования кнопки в зависимости от ip пользователя, второй метод для окрашивания кнопки в зависимости от четности страницы, третий метод реализует смену цвета кнопки самим пользователем.Замечу, что в ТЗ четко написан один вариант с зеленой кнопкой.

Ну так вот нагородили, потом через год другой ваши ifы будут переписываться на другие или на другую архитектуру, лучше тщательнее прорабатывайте ТЗ.

### Как бороться

Вообщем-то никак. Нужны варианты использования вашей системы, иногда проще все переписать.
Варианты сначала надо накопить, в идеале через тесты, вылить сырую систему на тестовый сервак, нужно много тестеров и времени, но бизнес не будет ждать.
Попробуй объясни клиенту для того, чтобы выполнить его просьбу , нужно отрефакторить, пересобрать стили и скрипты , написать или поправить тесты, вылить на тестовый сервак погоять недельку, выявить все баги, поправить их, и только потом в прод. В лучшем случае будет, если не придут новые правки.

Как все-таки меньше костылить:

- Использовать популярные библиотеки, не тащить свои велосипеды из проекта в проект
- Делать правильно, даже если больно и страдает бизнес. Обязательно писать тесты (Напишу как нибудь про разработку через тестирование)
- Обновлять продукт, когда ВСЕ проверено, все дыры подлатаны

Конечно это все обобщено, тут еще зависит от размера проекта, наш мир далеко не идеал, поэтому костыли никто не отменит.

