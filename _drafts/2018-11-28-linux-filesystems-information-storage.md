---
layout: post 
title: Файловые системы. Хранение информации
permalink: filesystems
tags: linux
--- 

Основные понятия:

Файловая система: FAT CDFS
На любом внешнем носителе, основная задача обесппечить хранение информации (иерария)

Но чтобы обеспечить доступ к ФС накопителя(локальный) существует дерево каталогов, тоже иерархическая
Дерево каталогов единственная структура где отображаються данные с внешнрих носителей

Сетевой носитель (nfs, smbfs)
Псевдофайловая система ()
Linux ufs ext2 ext3 ext4 fat - UFS
Не важно где файлы наодяться, они должны быть отображены в дереве каталогов
Дерево каталогов это / Root (RootFS) - именно туда в корневую файловую систему устанавливаеться
операционная система

Монтирование - это присоединение файловой системы к дереву каталогов

Правило адресации в дереве каталогов
От корня до обьекта существует только один путь

Абсолютный путь
Относительный путь 
Текущий каталог - рабочий .
Родительский каталог ..


Разделение символ прямой слеш, на самом деле это пустая строка

`mount` - то что уже было смонтированно

proc -  псевдовайлайвая файловая система о процессах
sys - псевдофайлая система об устройствах
44 минута
Ядро отдает информацию утилитам посредствам псевдофайловой системы, нет никакой магиии



## Типы файлов

**Обычный фаил**

Поименованная область данных на внешнем носителе
Храниться в ввиде блоков на диске

Метаданные 
1. type (тип файла) : Regular file
1. i-node(иднексный дискриптор) : 3454656
1. access mode (режим) : rwxr-----
1. dev : устройство на котором расположен фаил
1. uid (id владельца файла): 
1. gid (id владельца группы): 
1. owners (владелец файла): alex:alex
1. atime (время последнего доступа к файлу): 2018-11-27 22:28:00.448339805 +0300
1. mtime (когда был модифицированы данныеа файла): 2018-11-27 22:28:00.448339805 +0300
1. ctime (когда были изменены метаданные файла): 2018-11-27 22:28:00.448339805 +0300
1. counter (счетчик имен файла) : 3
1. disk blocks (номера блоков принадлежащий файлу): 45 67 23 89 67
 
Данные файла (не волнует операционную систему) имена храняться отдельно
 
**Каталог**

Служебный фаил

Метаданные 
1. type (тип файла) : Directory
1. i-node(идексный дискриптор) : 3454656
1. access mode (режим) : rwxr-----
1. dev : устройство на котором расположен каталог
1. uid (id владельца каталог): 
1. gid (id владельца каталог): 
1. owners (владелец каталога): alex:alex
1. atime (время последнего доступа к файлу): 2018-11-27 22:28:00.448339805 +0300
1. mtime (когда был модифицированы данныеа файла): 2018-11-27 22:28:00.448339805 +0300
1. ctime (когда были изменены метаданные файла): 2018-11-27 22:28:00.448339805 +0300
1. counter (счетчик имен каталога) : 3
1. disk blocks (номера блоков принадлежащий файлу): 45 67 23 89 67 
 
Список имен других файлов


. сам каталог ссылка на самого себя
.. родительский каталог
file cам фаил , по id inode находят метаданные файлы а уже по ним можно найти данные
hardlink (жесткая ссылка это просто эффект) - они могут находиться только в той же файловой системе что и сами файлы никто не запрещает создать несколько имен файла с тем же самым именем с одинаковыми id
symlink

Хрнение ufs
 
**Символическая ссылка**

Метаданные 
1. type (тип файла) : Symbolic link
1. i-node(идексный дискриптор) : 3454656
1. access mode (режим) : rwxr-----
1. dev : устройство на котором расположен каталог
1. uid (id владельца каталог): 
1. gid (id владельца каталог): 
1. owners (владелец каталога): alex:alex
1. atime (время последнего доступа к файлу): 2018-11-27 22:28:00.448339805 +0300
1. mtime (когда был модифицированы данныеа файла): 2018-11-27 22:28:00.448339805 +0300
1. ctime (когда были изменены метаданные файла): 2018-11-27 22:28:00.448339805 +0300
1. counter (счетчик имен каталога) : 3
1. disk blocks (номера блоков принадлежащий файлу): 45 67 23 89 67 

Обычный фаил, но данные его ведут на путь файла, работает в пределах дерева каталогов
Это ответ на ограничение жествих ссылок

**Фаил устройства**

Нужно изучать 

Метаданные 
1. type (тип файла) : Device file
1. i-node(идексный дискриптор) : 3454656
1. access mode (режим) : rwxr-----
1. dev : устройство на котором расположен каталог
1. uid (id владельца каталог): 
1. gid (id владельца каталог): 
1. owners (владелец каталога): alex:alex
1. atime (время последнего доступа к файлу): 2018-11-27 22:28:00.448339805 +0300
1. mtime (когда был модифицированы данныеа файла): 2018-11-27 22:28:00.448339805 +0300
1. ctime (когда были изменены метаданные файла): 2018-11-27 22:28:00.448339805 +0300
1. counter (счетчик имен каталога) : 3
1. major 23 система ввода вывода драйвер
1. minor 3                       устройство

При попытке прочитать этот файл, файловая система не задействована, читаем непосредственно через 
драйвер устройства непосредственно с устройсва

находится они в /dev

**Именованный канал**


Метаданные 
1. type (тип файла) : Named pipe
1. i-node(идексный дискриптор) : 3454656
1. access mode (режим) : rwxr-----
1. dev : устройство на котором расположен каталог
1. uid (id владельца каталог): 
1. gid (id владельца каталог): 
1. owners (владелец каталога): alex:alex
1. atime (время последнего доступа к файлу): 2018-11-27 22:28:00.448339805 +0300
1. mtime (когда был модифицированы данныеа файла): 2018-11-27 22:28:00.448339805 +0300
1. ctime (когда были изменены метаданные файла): 2018-11-27 22:28:00.448339805 +0300
1. counter (счетчик имен каталога) : 3

Средтва межпроцессного взаимодествия (IPC)
Общение программ в разных процессах

Обслуживат подсистема управления процессами

Процесс1
Процесс2
Процесс3

Общение только в одну сторону
simplex
fifo
memory buffer

halt просто сообщают что делать из одного процесса другому по средтвом именованного канала
reboot
poweroff

init все делает процесс init,


**Сокет**


Метаданные 
1. type (тип файла) : Named pipe
1. i-node(идексный дискриптор) : 3454656
1. access mode (режим) : rwxr-----
1. dev : устройство на котором расположен каталог
1. uid (id владельца каталог): 
1. gid (id владельца каталог): 
1. owners (владелец каталога): alex:alex
1. atime (время последнего доступа к файлу): 2018-11-27 22:28:00.448339805 +0300
1. mtime (когда был модифицированы данныеа файла): 2018-11-27 22:28:00.448339805 +0300
1. ctime (когда были изменены метаданные файла): 2018-11-27 22:28:00.448339805 +0300
1. counter (счетчик имен каталога) : 3


Обслуживат подсистема управления процессами

duplex
multiplexsing
memory buffer

Процесс сервер

Подключение к одному и тому же процессу

Процесс клиент1 Процесс клиент2 Процесс клиент3

syslogd

локальный и сетевой сокет



---------
Начнем говорить о файловых системах. Разберемся как храниться информация на жестких дисках.

Понятие сектора диска.
По сути это самая минимальная единица хранения информации на жестком диске, ранее размер сектора был 512 байт, современный
вариант 4096 байт. Группа секторов объединяется в блоки. Размер блока может задан в команде форматирования.

Ядро Linux работает с размером блока файловой системы, а не с размером сектора диска (обычно 512 байт)

Важно понимать, что размер блока файловой системы не может быть меньше размера сектора диска и всегда будет кратным ему. Также ядро ожидает, что размер блока файловой системы будет меньше или равно размеру системной страницы

Размер системной страницы можно увидеть выполнив команду

~~~bash 
getconf PAGE_SIZE
4096
~~~

> Что важно если фаил меньше 4 Кб, он все равно будет занимать 4 Кб


Каждый раз когда создается фаил - создается файловый дискриптор


----

