---
layout: post
title: Структура php проекта
permalink: php-project-structure
tags: php
comments: true
summary: В поисках удобной структуры php проекта.
is_navigate: true
cover_url: "/assets/images/articles/php.png"
---

Приступая к очередному проекту на php задумался, существует ли "правильная" структура проекта.
Попробуем разобраться.

### Постановка вопроса

Время от времени возникает потребность в переписывании проекта сделанном на каком-нибудь из старых
версий фреймворка или еще хуже с легаси кода. Увы, но так просто переписать к примеру с `Yii` на `Symfony` или с легаси
на `Laravel` не является возможным. Потому, что фреймворки не совместимы и не могут заменить друг друга.

Отсюда вопрос. Необходимо организовать такую структуру, при которой ядро приложения должно быть фреймворконезависимым.
То есть должна быть возможность менять фреймворк или параллельно использовать несколько фреймворков.

При этом важно разделять взаимодействие и чистый код приложения. Никогда не знаешь когда проект "устареет" и придется
все переписывать.

В общем важно правильно организовать структуру проекта, чтобы не было мучительно больно в будущем.

### Требования

Я стараюсь идти в ногу со временем поэтому в проекте используем современные подходы и инструменты.

1. Все зависимости загружаем через `composer`.
2. Используем статические и лексические анализаторы кода.
3. Разработку ведем по принципу `Code-First`, то есть пишем чистый рабочий код без [побочных эффектов](https://lexusalex.ru/pure-functions).
4. Не думаем о базе данных вообще, это вторично.
5. Автоматизируем все что только можно.
6. Обязательное тестирование кода.
7. Единая точка входа в приложение.
8. Для локальной разработки используем docker

### Запросы

Очевидно, что запросы в наше приложение могут прилетать через браузер, но только лишь через него...отнюдь.

Любой запрос попадает в контроллер, который в свою обрабатывает результат.
Клиентом в данном случае может выступать любая программа или сервис.

Создадим файл `public/index.php` точку входа в наше приложение.

```php
<?php

declare(strict_types=1);

require __DIR__ . '/../vendor/autoload.php';
```

К главному скрипту `index.php` мы можем получить доступ разными путями:

1. Через браузер
2. Через Api
3. Через консоль docker-compose run --rm php-cli php public/index.php var2 var3
4. Через очередь
5. Через мобильное приложение на Android
6. Через мобильное приложение на iOs
7. Другое

<img src="/assets/images/articles/php/ui.svg" alt="ui">

### Контроллеры

https://elisdn.ru/blog/105/services-and-controllers

### Сервисный слой
Архитектура как код.
https://elisdn.ru/blog/104/domain-entities-modelling

исходный код проекта https://github.com/LexusAlex/php-compact
