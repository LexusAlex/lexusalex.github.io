---
layout: post 
title: Установка UNIX
permalink: unix-install
tags: unix linux
--- 

Инсталятор - это программа для установки операционной системы

Бывают два режима инсталяции:
1. Интерактивный режим - установка одной ОС
2. Пакетный режим - установка N ОС


Определяем источник инталяции CD, HDD, NFS, FTP, HTTP


Опции инсталяции - Как инсталяировать
Куда инсталировать - Разбиение диска

Диски разбиваются на разделы, в разделе создается ФС
Цель создать дерево каталогов

Что инсталировать Инсталяция пакетов . Драйвера входят в пакеты
Пакет, Группа пакетов, Кластер
Репозиторий - дерево зависимостей пакетов

Основная единица ПО - это пакет

Процесс копирования пакетов

Далее может начаться Постинсталиционное конфигурирование

Перезагрузка

Далее ОС начнется загружаться из того дерева каталгов куда ее инсталировали


Управление ПО

Пакет php.deb - это архив . Пакеты находятся в репозитории, список зависимостей между пакетами, инструкции по
инсталяции, инструкции по деинсталяции

Пакет - это функциональная единица

Менеджер пакетов - инсталяции / деинсталяция пакетов
Red Hat - rpm
Debian - dpkg - debian package manager

Менеджеры зависимостей - работает с зависимостей
Red Had Cent Os - yum yellow dog update manager
Debian - apt-get auto package tool

Одна программа решает одну задачу

dpkg -l

Название версия релиз архитектура
liburl-dispatcher1:amd6 0.1+16.04.201511 amd64

Список файлов пакета
dpkg -L wget

ii - установлен и файлы и документация
rc - удален но осталвены конфигурационные файлы

Инсталяция - это не только распаковка и установка но еще и его настройка

Нельзя просто так взять и удалить пакет - вот для этого существуют менеджеры зависимотей

Репозиторий список пакетов с зависимостями между ними


Конфигурационные файлы пример /etc/passwd

Декларативные
Таблица с разделителями field1:field2:fieldn выбран один символ для разделения в конце должен стоять символ перевода строки
Простая таблица field1 field2 fieldn (TAB, space) - сколько угодно пробелов символ для разделения в конце должен стоять символ перевода строки

Каждый конфигурационный файил имеет справку

Импреативные
Командный файл shell, программа которая выполняется

Var1 = val1
Var2 = val2

Находятся в каталог /etc/ документация может быть в свободном текстовом формате
Всегда можно узнать к какому пакету принадлежит фаил


Документация
Manual pages /usr/share/man 8 секций документации
Info pages /usr/share/info
Documentation /usr/share/doc


Полномочия

sudo - передача полномочий
/etc/sudoers - конфигарационный фаил кому разрешено передавать полномочия
/etc/sudo.d/*

программа visudo - идет проверка синтаксиса файла
# - это комментарий

u      h u     cmd
root ALL=(ALL) ALL

Суперпользователю на любых узлах от любых третьих лиц можно запускать все что угодно

Настройка прав

http://rus-linux.net/kos.php?name=/papers/boot/index.html#pred

Пользовательские учетные записи

Бывают реальные пользователи и пользователи служб

USER

/etc/passwd - Публичная таблица
/etc/shadow - Приватная таблица

username - имя пользователя без пробелов, цифры и буквы тоже самое в двух таблицах
password - пароль - x - отсуствует в публичной таблице, в закрытой хранится его хеш
UID - id пользователя
GID - id Группы пользователя
GCOS - комментарий
home-dir - домашний каталог
shell - командный интерпретатор

lastchange дни с 1.01.1970 до момента когда пользователь последний разменял пароль - 17334
min - минимальный возраст пароля - 0
max - максимальное кол-во дней через сколько точка когда пользователь должен сменить пароль - 99999
warn - дней сколько пользователя предупреждают через сколько нужно сменить пароль - 7
inactive - дней до деактивации учетной записи, до принудительного отключения
expire - возраст учетной записи целиом, от 1.01.1970 промежуток действия целиком дд

Чтобы отключить поле мнужно поставить пустоту
username:password:UID:GID:GCOS:home-dir:shell
username:password:lastchange:min:max:warn:inactive:expire
              
root:x:0:0:root:/root:/bin/bash

В открытой части не хранятся пароли
Пароли ранятся в закрытом файле в хешированном виде, но только у живых пользователей, у всех остальных
там стоит * или !! или ! - это сделано для того чтобы нельзя войти под этими пользователями


passwd -l student - заблокировать учетную запись
passwd -u student - разблокировать учетную запись

GROUP

В случае с группами все тоже самое 

/etc/group - Публичная таблица групп
/etc/gshadow - Приватная таблица групп

Когда то существовал пароль группы
Список членов группы существует динамически

Появились администраторы группы, которые могут изменять список членов группы

groupname:password:GID:mem,mem,mem,mem
groupname:password:admin,admin...:mem,mem,mem,mem


id alex - узнать id пользователя
groups alex - список групп
finger alex - доп инфо
chage -l alex

Так же существуют конфигурационные файлы для них

useradd - создать пользователя

Файлы пользователя пользовательского профиля

Общисистемный профиль /etc - 1
Профиль по умолчанию /ect/skel
Профиль пользователя $Home home dir - 2
