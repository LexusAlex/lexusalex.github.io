---
layout: post 
title: Загрузка операционной системы
permalink: filesystems
tags: linux
--- 

## Структура

Из чего состоит диск:

Сектор - единица хранения информации на диске (4096 б)
Раздел - часть памяти диска
Главная загрузочная запись (MBR) - код необходимый для последующей загрузки ОС

## Загрузка операционной системы


1. Процедура POST (ROM BIOS)
   POWER ON SELF TEST
   
   Del - запустить setup , которая в микросхеме bios, допустим будем грузиться с жесткого диска
2. ROM LOADER (ROM BIOS) 
3. Основная задача ROM LOADER прочитать энергонезависимую память (NVRAM) где храняться настройки загрузки
4. MBR Loader первые 512 байт на диске Главная загрузочная запись Master boot record (0 этап загрузки) выбор ос

Таблица разделов диска, 
MBR PBR PBR PBR
     P1  P1  P1
          *boot
5. PBR Loader Загрузочная запись раздела active partition boot record - active partition (1 этап загрузки) микрозагрузчик
6. OS Loader / параметры загрузки ядра, ядро это просто программа active partition (2 этап загрузки) загрузчик ос

LILO (Linux LOader)

/etc/lili.conf , строит карту загрузки, /

GRUB (Grand unified Bootloader)

Работает более классически, по шагам

Stage 1 - 512 байт (MBR)
Stage 2 со вторым этапом мы взаимодействуем
Способы загрузки ядра у них разные

/sbin/grub - инсталятор загрузчика

появляется меню

root (hd0,0)
kernel /boot/vmlinuz-2.4 ro root=UUID=
initrd /boot/initramfs-2.5.img

Взаимодействие с загрузчиком

7. Kernel
8. Монтирование корневой фаловой системы Rootfs
9. /sbin/init PID = 1 первый процесс
    
Ядро состоит из двух файлов
vmlinux остов ядра
initrd модули ядра

*.ko модули ядра
заранее не известно на каком оборудовании будет работать система

initrd или initramfs
Модули ядра
Драйвер файловой системы
Драйвер диска
Драйвер контроллера
драйвер шины

man boot
man bootparam

ядро обычно устанавливатеся в каталоге boot


Самый первый сектор это MBR, в конце MBR содержиться таблица разделов

----

