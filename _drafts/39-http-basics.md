---
layout: default
nav_order: 39
permalink: 39-http-basics
title: Протокол HTTP
parent: Заметки
description: Что такое HTTP
date: 2022-11-08 17:00:00 +3
last_modified_date: 2022-11-08 17:00:00 +3
tags:
- http
---

# Протокол HTTP
{: .no_toc }

<details open markdown="block">
  <summary>
    Содержание
  </summary>
  {: .text-delta }
1. TOC
{:toc}
</details>
---

HTTP - Протокол передачи гипертекста.

## Особенности:

- В HTTP/1.1 был введён механизм Connection: Keep-Alive, что позволяет использовать одно соединение для более чем одного запроса
- HTTP не зависит от типа контента
- HTTP не имеет никаких промежуточных состояний
- HTTP/1.1 позволяет клиентам отправлять несколько запросов одновременно, при этом не ждать каждого ответа

Сеанс HTTP - это последовательность запрос-ответ

## Клиент

HTTP Клиент - отправляет запрос на сервер одним из методов запроса, путь и версию протокола.

## Сервер

HTTP-сервер, прослушивающий порт на который пришел запрос

## Характеристики протокола

## Структура HTTP сообщения

Они должны быть в следующем порядке:

- Стартовая строка
- Заголовки
- Пустая строка
- Тело сообщения

### Стартовая строка

Первая строка запрос

```http request
GET / HTTP/1.1
```

Первая строка ответ

```http request
HTTP/1.1 200 Ok
```

### Заголовки

Заголовки бывают разных видов

- Общие заголовки - могут быть как в запросе, так и в ответе
- Заголовки запроса - могут быть только в сообщении запроса
- Заголовки ответа - могут быть только в ответе
- Заголовки сущности - содержат информацию об объекте

Пример заголовка:

```http request
Host: ya.ru
```

### Пустая строка

Пустая строка отделяет заголовки от тела сообщения.

### Тело сообщения

Это часть, которая содержит непосредственно данные запроса, что может быть:

- html код
- данные веб форм
- различные ресурсы (изображения, шрифты)

## Запрос

Состоит из следующих элементов

- Строка запроса (Метод URI Версия HTTP)
- Поля заголовков
- Пустая строка
- Необязательное тело сообщения

### Строка запроса

В общем виде строка запроса выглядит так `Метод URI Версия HTTP`

#### Метод запроса

По сути это то, что мы хотим сделать с ресурсом.

Название метода всегда указывается в верхнем регистре
Не существует обязательных методов, если сервер не понял метод, он вернет статус 501,
если метод не может быть использован на текущем ресурсе, то вернется статус 405

Так же сервер должен вернуть заголовок со списком поддерживаемых методов

##### GET

Нужен для запроса содержимого указанного ресурса

```http request
GET /education/group-uc/create/?group_id=5965 HTTP/1.1
```

Запрос типа GET считается идемпотентным, то есть при одинаковых параметрах
возвращает одинаковый результат.

- условный GET 
  - If-Modified-Since
  - If-Match
  - If-Range
- частичный GET
  - Range

##### HEAD

В ответе сервера отсутствует тело запроса

Обычно этот метод используется для получения мета данных, валидации ответа сервера
Заголовки ответа могут кешироваться.

##### POST

Передача пользовательских данных ресурсу и передача файлов.

Передачаемые данные включаются в тело запроса.

метод POST не считается идемпотентным

Если ресурс был создан то сервер должен вернуть ответ 201 (Created)

Сообщение не кешируется

##### PUT

Загрузить содержимого запроса на указанных URI, если ресурса не было, то он его создаст 201 (Created)
Если он был изменен то  200 (Ok) или 204 (No Content)

501 (Not Implemented).

Фундаментальное различие методов POST и PUT заключается в понимании предназначений URI ресурсов. Метод POST предполагает, что по указанному URI будет производиться обработка передаваемого клиентом содержимого. Используя PUT, клиент предполагает, что загружаемое содержимое соответствует находящемуся по данному URI ресурсу. 

##### DELETE

Удалить указанный ресурс

##### CONNECT
##### OPTIONS
##### TRACE
##### PATCH

#### URI

Уникальный идентификатор ресурса, к которому применить запрос.

- `*`
- `http://site/pub/WWW/TheProject.html`
- `/pub/WWW/TheProject.html`

### Поля заголовков

Сам клиент добавляет нужные ему заголовки

*   Accept-Charset
*   Accept-Encoding
*   Accept-Language
*   Authorization
*   Expect
*   From
*   Host
*   If-Match
*   If-Modified-Since
*   If-None-Match
*   If-Range
*   If-Unmodified-Since
*   Max-Forwards
*   Proxy-Authorization
*   Range
*   Referer
*   TE
*   User-Agent


https://habr.com/ru/company/nix/blog/304518/


### Пустая строка

### Тело сообщения

## Ответ

Может состоять из следующих элементов

- Строка состояния
- Поля заголовков ответа
- Пустая строка
- Тело сообщения

### Строка состояния

Общий вид выглядит следующим образом 

`Версия http Код состояния Текст состояния`

#### Версия http

- HTTP/1.0
- HTTP/1.1
- HTTP/2

#### Код состояния и тест состояния

Клиент может не знать все коды состояния, но он обязан отреагировать в соответствии с классом кода.

Существует пять классов кодов состояния

##### 1xx Информационные
##### 2xx Успешно
##### 3xx Перенаправления
##### 4xx Ошибка клиента
##### 5xx Ошибка сервера


### Поля заголовков ответа

Позволяют серверу передавать дополнительную информацию об ответе

*   Accept-Ranges
*   Age
*   ETag
*   Location
*   Proxy-Authenticate
*   Retry-After
*   Server
*   Vary
*   WWW-Authenticate

### Пустая строка
### Тело сообщения